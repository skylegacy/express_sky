
 <!DOCTYPE html>
 <html>
 <head>
     <meta charset="UTF-8">
     <link href="https://cdn.rawgit.com/TeaMeow/TocasUI/2.3.2/dist/tocas.css" rel='stylesheet'>
     <script src="https://cdn.rawgit.com/TeaMeow/TocasUI/2.3.2/dist/tocas.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/vue"></script>
     <script src="https://code.jquery.com/jquery-3.5.1.min.js" ></script>
     <title>儀表板範例 | Tocas UI</title>
     <style type="text/css">
         html, body {
             height: 100%;
         }
         .pusher {
             background-color: rgb(250, 250, 250);
         }
     </style>
 </head>
 <body>
     <%- include('../comp/sidemenu'); %>
 
     <!-- 可擠壓式的推動容器 -->
     <div class="squeezable pusher">
        
         <br>
 
         <!-- 主要容器 -->
         <div class="ts narrow container">
             <div class="ts relaxed grid">
                 <!-- 標題欄位 -->
                 <div class="sixteen wide column">
                     <h3 class="ts header">
                         <%= title %>
                         <div class="sub header">這是後台,需要有session認證,才能造訪。</div>
                     </h3>
                 </div>
                 <!-- / 標題欄位 -->
 
                 <!-- 大略卡片欄位 -->
                 <div class="sixteen wide column">
                     
                     <!-- 區隔線 -->
                     <div class="ts section divider"></div>
                     <!-- / 區隔線 -->
                 </div>
                 <!-- / 大略卡片欄位 -->
 
                 
                <div class="sixteen wide column">
                     
                        <div  class="ts top attached info segment">
                                <div class="ts large header">
                                        路由方法清單 
                                        <a href="/admin/role/edit"
                                         class="ts right floated mini compact button">新增</a>
                                </div>
                         </div>
                         <div class="ts attached segment">
    
                             <table id="app" class="ts table fixed ">
                                 <thead>
                                     <tr>
                                         <th>#</th>
                                         <th>角色名稱</th>
                                         <th>路由數</th>
                                         <th>action</th>
                                     </tr>
                                 </thead>
                                 <tbody>
                                        <template v-for="item in rowContrl">
                                                <parenttr 
                                                v-bind:routename="item.RoleName"
                                                v-bind:editid="item.id"
                                                countself=1
                                                >
                                                <childhref v-bind:linkNum="item.id" slot="minibtn"></childhref>
                                                </parenttr> 
                                        
                                        </template>
                                      
                                 </tbody>

                            </table>

                         </div>
                    
                 </div> 
  
             </div>
         </div>
         <!-- / 主要容器 -->
 
         <br>
     </div>
     <!-- / 可擠壓式的推動容器 -->

     <script>

            var listRow = <%- $listData %>;
            console.log(listRow);

            var globalData = {
             counter:0
            }


            var vm = new Vue({
                el: '#app',
                
                data:function(){
                    return {
                        rowContrl: listRow,
                    }
                },
               
                components: {
                    'parenttr':{
                        props: ['num','routename','countself','editid' ],
                        data:function(){
                            return {
                                num:0,
                                routename:null,
                                countself:false,
                            }
                        },
                        mounted:function(){
                            if(this.countself==true){
                                    this.incrementHandler(this);
                            } 
                        },
                        methods:{
                                incrementHandler: function (obj) {
                                    globalData.counter++;
                                    obj.num = globalData.counter;
                                }
                        },
                        template:`<tr>
                                    <td>{{num}}</td>
                                    <td>{{routename}}</td>
                                    <td>{{editid}}</td>
                                    <td><slot name="minibtn"></slot></td>
                                  </tr>`
                    },
                    'childhref':{
                        props:['text','linknum'],
                        mounted:function(){
                            console.log('AA'+this.linknum);
                            this.deployBtn();
                        },
                        methods:{
                            deployBtn:function(){
                                this.linkurl = '/admin/role/edit/'+this.linknum; 
                            }
                        },
                        data:function(){
                                return {
                                    linkurl:null
                                }
                        },
                        template:` <a v-bind:href="this.linkurl" class="ts mini icon button">
                                <i class="edit icon"></i>
                            </a>  `
                    }

                }
            })

     </script>
 </body>
 </html>
 